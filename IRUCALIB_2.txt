IRUCAL_2.txt
2013-01-21
Wm. S. Davis / E. Martin

IRU calibration steps with getirudata_33c & matpycal_10.m
with directory structure currently as in pcad/IRUCALIB.

* Login to Greta network, ssh to chimchim

* Set ska environment if needed
  - ska (if alias defined) or
  - source /proj/sot/ska/bin/ska_envs.csh

Aliases currently in .cshrc :
alias ska  'unsetenv PERL5LIB; source /proj/sot/ska/bin/ska_envs.csh; set prompt="ska-$prompt"'
alias pylab "ipython --pylab"
alias xt "xterm -bg black -fg green &"

* Open a new xterm window with "xt" and enter "ska"
  - Subsequent steps are executed in this window

* Update aoatter_bad_times.dat file if needed
  - From the root of the irucalib project, cd Python/Getirudata
  - start ipython using "pylab" alias
  - in ipython %run aoatter02.py
  - after aoatter02 is finished ("Done!"), select figure 4
  - identify time spans where attitude error exceeds 2.5 arcsec
  - expand each such time span to obtain start and stop times
    of attitude error exceeding 1.0 arcsec
  - edit aoatter_bad_times.dat to include new start & stop times
  - exit editors and ipython

* Get preprocessed IRU data from ska archive
  - From the root of the irucalib project, cd Python/Getirudata
  - interval 29 is selected by default
  - edit getirudata33c.py for times and flags for selected interval
    > confirm selected interval in Initialization section
    > in the interval definition section, set start and stop times by
      editing values of tstart and tstop for selected interval and
      set interval label as needed
    > edit values of true/false flags as needed >>>> define "as needed" <<<<
    > save & close file
  - run ipython using "pylab" alias
  - in ipython %run getirudata33c.py
  - after getirudata33c.py is finished, review figures
  - exit editors and ipython
  - output files have names getirudata_lbl_33c.ext, where ext is 
    "out" and "sum", and lbl is the interval label

* Run IRU calibration Kalman estimator for data in time interval
  of previous step
  - copy getirudata33c.py used above into ~/IRUCALIB/Matlab/Matpycal_10/MATPYCAL10_33c
  - convert Getirudata output text file to mat-file format
    > copy getirudata_lbl_33c.out to getirudata_lbl_33c.prn in
      ~/IRUCALIB/Matlab/Matpycal_10/MATPYCAL10_33c
    > cd to above directory and edit getirudata_lbl_33c.prn
    > delete row of column labels and change all ":" to spaces
    > save and exit editor
    > start matlab and cd to 
      ~/IRUCALIB/Matlab/Matpycal_10/MATPYCAL10_33c
    > run matlab function by entering, 
      iruascii2mat(filename,aber_adjust); where filename is 
      getirudata_lbl_33c.prn and aber_adjust is true or false
      (the opposite of what was used in Getirudata)
    > confirm existance of getirudata_lbl_33c.mat
  - process getirudata_lbl_33c.mat file with matpycal10
    > run matpycal10 in matlab window: >> matpycal10();
    > Select and confirm desired IRU mat-file
    > Select Yes for senerate plots and save plots
    > Select No for adjust for m-matrix
    > review plots (for above time interval) in figures and
      summary in command window
  - if time interval includes one or more previous calibration uplinks, repeat
    previous step, but select Yes for adjust for m-matrix -- note that saved
    files using 9-parameter calibration from previous step will be overwritten
  - obtain plots of 3-vector and 4-vector biases
    > run matpybias in matlab window: >> matpybias('getirudata_lbl_v33c.mat',true);
    > review plots in figures and summary in command window

* Run IRU calibration Kalman estimator for data going back to 
  beginning of current on-board IRU gyro configuration time 
  including new data interval
  - Note that all saved files from previous step will be overwritten by this step
  - append new getirudata to file previous data, going back to 
    beginning of current on-board IRU gyro configuration time
    (file 'getirudata_i99_v33c.prn'),     replacing previous 
    data as needed
  - convert Getirudata output text file to mat-file format,
    'getirudata_i99_v33c.prn' --> 'getirudata_i99_v33c.mat'
  - process getirudata_i99_33c.mat file with matpycal10 & matpybias
    as in the previous step
  - reprocess getirudata_i99_33c.mat file with matpycal10 as in the previous
    step, but select Yes for adjust for m-matrix -- note that saved files using
    9-parameter calibration from previous step will be overwritten

* Archive files generated by the above steps

